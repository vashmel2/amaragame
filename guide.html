<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Game Platform — Developer Guide</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg: #F8F9FA;
      --surface: #FFFFFF;
      --text: #2D3436;
      --text-mid: #636E72;
      --primary: #6C5CE7;
      --primary-light: #A29BFE;
      --accent: #00B894;
      --code-bg: #1E1E2E;
      --code-text: #CDD6F4;
      --border: #E0E0E0;
    }

    body {
      font-family: 'Nunito', system-ui, -apple-system, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.7;
      padding: 0 20px 80px;
    }

    .container {
      max-width: 820px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      padding: 48px 0 32px;
      border-bottom: 2px solid var(--border);
      margin-bottom: 40px;
    }

    header h1 {
      font-size: 2.2rem;
      font-weight: 800;
      color: var(--primary);
    }

    header p {
      color: var(--text-mid);
      font-size: 1.1rem;
      margin-top: 8px;
    }

    h2 {
      font-size: 1.5rem;
      font-weight: 800;
      margin: 48px 0 16px;
      padding-bottom: 8px;
      border-bottom: 2px solid var(--primary-light);
      color: var(--primary);
    }

    h3 {
      font-size: 1.15rem;
      font-weight: 700;
      margin: 28px 0 10px;
    }

    p, li {
      font-size: 1rem;
      color: var(--text);
      margin-bottom: 10px;
    }

    ul, ol {
      padding-left: 24px;
      margin-bottom: 16px;
    }

    li { margin-bottom: 6px; }

    code {
      font-family: 'Cascadia Code', 'Fira Code', 'Consolas', monospace;
      background: #EDE7F6;
      color: #5B21B6;
      padding: 2px 7px;
      border-radius: 5px;
      font-size: 0.9em;
    }

    pre {
      background: var(--code-bg);
      color: var(--code-text);
      border-radius: 12px;
      padding: 20px 24px;
      overflow-x: auto;
      margin: 16px 0 24px;
      font-size: 0.88rem;
      line-height: 1.6;
    }

    pre code {
      background: none;
      color: inherit;
      padding: 0;
      font-size: inherit;
    }

    .card {
      background: var(--surface);
      border-radius: 16px;
      padding: 24px 28px;
      margin: 20px 0;
      box-shadow: 0 2px 12px rgba(0,0,0,0.06);
      border-left: 4px solid var(--primary);
    }

    .card.green { border-left-color: var(--accent); }

    .file-tree {
      background: var(--surface);
      border-radius: 12px;
      padding: 20px 24px;
      font-family: 'Cascadia Code', 'Fira Code', 'Consolas', monospace;
      font-size: 0.9rem;
      line-height: 1.8;
      box-shadow: 0 2px 12px rgba(0,0,0,0.06);
      margin: 16px 0 24px;
    }

    .file-tree .dir  { color: var(--primary); font-weight: 700; }
    .file-tree .file { color: var(--text); }
    .file-tree .note { color: var(--text-mid); font-style: italic; }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 16px 0 24px;
      font-size: 0.95rem;
      background: var(--surface);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 12px rgba(0,0,0,0.06);
    }

    th {
      background: var(--primary);
      color: white;
      font-weight: 700;
      text-align: left;
      padding: 12px 16px;
    }

    td {
      padding: 12px 16px;
      border-top: 1px solid var(--border);
      vertical-align: top;
    }

    tr:hover td { background: #F5F3FF; }

    .badge {
      display: inline-block;
      padding: 3px 10px;
      border-radius: 100px;
      font-size: 0.8rem;
      font-weight: 700;
    }

    .badge-platform { background: #EDE7F6; color: #5B21B6; }
    .badge-game     { background: #E8F5E9; color: #2E7D32; }

    .step-number {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      background: var(--primary);
      color: white;
      border-radius: 50%;
      font-weight: 800;
      font-size: 0.9rem;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .step {
      display: flex;
      align-items: flex-start;
      margin: 16px 0;
    }

    .step-content { flex: 1; }
    .step-content p:first-child { font-weight: 700; margin-bottom: 4px; }

    hr {
      border: none;
      border-top: 1px solid var(--border);
      margin: 48px 0;
    }

    .key-value {
      display: grid;
      grid-template-columns: 160px 1fr;
      gap: 4px 16px;
      margin: 12px 0;
    }

    .key-value dt {
      font-weight: 700;
      color: var(--primary);
    }

    .key-value dd {
      color: var(--text);
      margin-bottom: 8px;
    }

    @media (max-width: 600px) {
      header h1 { font-size: 1.6rem; }
      pre { padding: 14px 16px; font-size: 0.82rem; }
      .key-value { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="container">

    <header>
      <h1>&#x1F3AE; Game Platform — Developer Guide</h1>
      <p>Architecture, extension points, and how everything fits together.</p>
    </header>

    <!-- ======================================== -->
    <h2>&#x1F4C1; Project Structure</h2>

    <div class="file-tree">
      <span class="dir">amaragame/</span><br>
      &nbsp;&nbsp;├── <span class="file">index.html</span> <span class="note">— app shell</span><br>
      &nbsp;&nbsp;├── <span class="file">guide.html</span> <span class="note">— this file</span><br>
      &nbsp;&nbsp;├── <span class="dir">css/</span><br>
      &nbsp;&nbsp;│&nbsp;&nbsp;&nbsp;└── <span class="file">style.css</span> <span class="note">— all platform + game styles</span><br>
      &nbsp;&nbsp;├── <span class="dir">js/</span><br>
      &nbsp;&nbsp;│&nbsp;&nbsp;&nbsp;├── <span class="file">storage.js</span> <span class="note">— storage abstraction <span class="badge badge-platform">platform</span></span><br>
      &nbsp;&nbsp;│&nbsp;&nbsp;&nbsp;├── <span class="file">profile.js</span> <span class="note">— child profiles <span class="badge badge-platform">platform</span></span><br>
      &nbsp;&nbsp;│&nbsp;&nbsp;&nbsp;├── <span class="file">progress.js</span> <span class="note">— per-game progress <span class="badge badge-platform">platform</span></span><br>
      &nbsp;&nbsp;│&nbsp;&nbsp;&nbsp;├── <span class="file">registry.js</span> <span class="note">— game registry <span class="badge badge-platform">platform</span></span><br>
      &nbsp;&nbsp;│&nbsp;&nbsp;&nbsp;├── <span class="file">audio.js</span> <span class="note">— sound effects <span class="badge badge-platform">platform</span></span><br>
      &nbsp;&nbsp;│&nbsp;&nbsp;&nbsp;├── <span class="file">app.js</span> <span class="note">— main controller &amp; navigation <span class="badge badge-platform">platform</span></span><br>
      &nbsp;&nbsp;│&nbsp;&nbsp;&nbsp;└── <span class="dir">games/</span><br>
      &nbsp;&nbsp;│&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└── <span class="file">feed-monster.js</span> <span class="note">— Feed the Monster <span class="badge badge-game">game</span></span><br>
      &nbsp;&nbsp;└── <span class="dir">assets/</span> <span class="note">— for future images &amp; sounds</span><br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;├── <span class="dir">images/</span><br>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└── <span class="dir">sounds/</span>
    </div>

    <!-- ======================================== -->
    <h2>&#x1F3D7;&#xFE0F; Architecture</h2>

    <div class="card">
      <h3>Two layers, cleanly separated</h3>
      <p><strong>Platform layer</strong> <span class="badge badge-platform">platform</span> — app shell, navigation, profiles, progress storage, game registry. Stable and long-lived.</p>
      <p><strong>Game layer</strong> <span class="badge badge-game">game</span> — each game is self-contained. Receives a DOM container and a callbacks object. Knows nothing about storage, navigation, or other games.</p>
    </div>

    <h3>Key principle</h3>
    <p>Games <strong>never</strong> import storage, profile, or navigation modules directly. They only talk to the platform through the <code>callbacks</code> object passed to their <code>init()</code> method. This means the entire platform can change without touching any game code.</p>

    <h3>The callbacks contract</h3>
    <p>Every game's <code>init(container, callbacks)</code> receives:</p>
    <dl class="key-value">
      <dt><code>onExit()</code></dt>
      <dd>Call to return to the main menu.</dd>
      <dt><code>onProgress(data)</code></dt>
      <dd>Save progress data (object merged with existing progress).</dd>
      <dt><code>getProgress()</code></dt>
      <dd>Returns a Promise with the saved progress for this game + profile.</dd>
      <dt><code>profile</code></dt>
      <dd>Object with <code>{ id, name, avatar }</code> of the current child.</dd>
    </dl>

    <!-- ======================================== -->
    <h2>&#x1F579;&#xFE0F; How to Add a New Game</h2>

    <div class="step">
      <span class="step-number">1</span>
      <div class="step-content">
        <p>Create the game file</p>
        <p>Add <code>js/games/my-game.js</code>:</p>
      </div>
    </div>

<pre><code>import { GameRegistry } from '../registry.js';
import { Audio } from '../audio.js';

const MyGame = {
  // ── Registry metadata ──
  id: 'my-game',
  title: 'My Cool Game',
  category: 'reading',           // must match a registered category
  thumbnail: '\u{1F4DA}',
  description: 'A fun reading game!',
  ageRange: [5, 8],

  // ── Internal state ──
  _container: null,
  _callbacks: null,

  init(container, callbacks) {
    this._container = container;
    this._callbacks = callbacks;

    // Build your game UI inside container
    container.innerHTML = `
      &lt;div class="my-game"&gt;
        &lt;button id="my-exit"&gt;Back&lt;/button&gt;
        &lt;h1&gt;Hello, ${callbacks.profile.name}!&lt;/h1&gt;
      &lt;/div&gt;`;

    container.querySelector('#my-exit')
      .addEventListener('click', () =&gt; callbacks.onExit());

    // Load saved progress
    callbacks.getProgress().then(progress =&gt; {
      // Use progress.currentLevel, progress.custom, etc.
    });
  },

  destroy() {
    // Clean up timers, event listeners, etc.
    if (this._container) this._container.innerHTML = '';
    this._container = null;
    this._callbacks = null;
  }
};

GameRegistry.register(MyGame);</code></pre>

    <div class="step">
      <span class="step-number">2</span>
      <div class="step-content">
        <p>Import it in app.js</p>
        <p>Add one line near the top of <code>js/app.js</code>:</p>
      </div>
    </div>

<pre><code>import './games/feed-monster.js';
import './games/my-game.js';       // &lt;-- add this</code></pre>

    <div class="step">
      <span class="step-number">3</span>
      <div class="step-content">
        <p>Add styles (optional)</p>
        <p>Add a section in <code>css/style.css</code>, or inject a <code>&lt;style&gt;</code> element from your game's <code>init()</code> method.</p>
      </div>
    </div>

    <div class="card green">
      <p><strong>That's it.</strong> Your game will appear automatically in the matching category tile on the main menu. No routing, no config files, no build step.</p>
    </div>

    <!-- ======================================== -->
    <h2>&#x1F3F7;&#xFE0F; How to Add a New Category</h2>

    <p>Categories are defined in <code>js/registry.js</code>. To add one, call this anywhere before games register (e.g. top of <code>app.js</code>):</p>

<pre><code>import { GameRegistry } from './registry.js';

GameRegistry.addCategory('music', 'Music', '\u{1F3B5}', '#FF6BCB');</code></pre>

    <p>Then register games with <code>category: 'music'</code>. The category tile appears in the menu only when it has at least one game.</p>

    <h3>Built-in categories</h3>
    <table>
      <thead><tr><th>ID</th><th>Label</th><th>Icon</th><th>Color</th></tr></thead>
      <tbody>
        <tr><td><code>counting</code></td><td>Counting</td><td>&#x1F522;</td><td><code>#FF9F43</code></td></tr>
        <tr><td><code>reading</code></td><td>Reading</td><td>&#x1F4D6;</td><td><code>#54A0FF</code></td></tr>
        <tr><td><code>thinking</code></td><td>Thinking</td><td>&#x1F9E9;</td><td><code>#5F27CD</code></td></tr>
        <tr><td><code>feelings</code></td><td>Feelings</td><td>&#x1F49B;</td><td><code>#FF6B6B</code></td></tr>
      </tbody>
    </table>

    <!-- ======================================== -->
    <h2>&#x1F4BE; Data &amp; Storage</h2>

    <h3>How it works</h3>
    <p>All data flows through <code>js/storage.js</code>, which wraps <code>localStorage</code> behind an async interface. Two keys are stored (prefixed <code>amaragame_</code>):</p>

    <table>
      <thead><tr><th>Key</th><th>Contains</th></tr></thead>
      <tbody>
        <tr><td><code>amaragame_profiles</code></td><td>Child profiles &amp; which profile is active</td></tr>
        <tr><td><code>amaragame_progress</code></td><td>Per-profile, per-game progress</td></tr>
      </tbody>
    </table>

    <h3>Progress data shape</h3>
<pre><code>{
  "version": 1,
  "profiles": {
    "p_abc123": {
      "feed-monster": {
        "sessionsPlayed": 5,
        "currentLevel": 2,
        "bestLevel": 2,
        "lastPlayed": "2026-02-10T...",
        "custom": {}
      }
    }
  }
}</code></pre>

    <p>You can inspect this in DevTools &rarr; Application &rarr; Local Storage. To reset everything, delete both <code>amaragame_</code> keys.</p>

    <!-- ======================================== -->
    <h2>&#x1F680; How This Evolves Later</h2>

    <table>
      <thead><tr><th>Future need</th><th>What changes</th><th>What stays untouched</th></tr></thead>
      <tbody>
        <tr>
          <td><strong>Backend sync</strong></td>
          <td>Write a new adapter class, call <code>Storage.setAdapter(new ApiAdapter())</code></td>
          <td>All game code, all platform UI</td>
        </tr>
        <tr>
          <td><strong>Multiple children</strong></td>
          <td>Add a profile-picker screen before the menu</td>
          <td>Games, storage, progress (already multi-profile)</td>
        </tr>
        <tr>
          <td><strong>Framework migration</strong></td>
          <td>Wrap <code>app.js</code> in React/Vue, render the <code>#app</code> div</td>
          <td>Every game &mdash; they only need a DOM container + callbacks</td>
        </tr>
        <tr>
          <td><strong>Real art &amp; sounds</strong></td>
          <td>Replace emoji thumbnails with <code>&lt;img&gt;</code> tags, swap Audio functions for <code>.mp3</code> files</td>
          <td>All game logic, all platform logic</td>
        </tr>
        <tr>
          <td><strong>Harder difficulty</strong></td>
          <td>Adjust the <code>LEVELS</code> array in any game, or add a "Check" button for older kids</td>
          <td>Platform, other games</td>
        </tr>
        <tr>
          <td><strong>Classrooms / multiplayer</strong></td>
          <td>Add backend + room codes at the storage/profile layer</td>
          <td>Every game</td>
        </tr>
      </tbody>
    </table>

    <!-- ======================================== -->
    <h2>&#x1F3AC; How to Run</h2>

    <p>Since this project uses ES modules (<code>type="module"</code>), you need a local server. Opening <code>index.html</code> directly from the filesystem won't work.</p>

    <div class="card">
      <h3>Option A — VS Code Live Server</h3>
      <p>Install the <strong>Live Server</strong> extension. Right-click <code>index.html</code> &rarr; <strong>Open with Live Server</strong>.</p>
    </div>

    <div class="card">
      <h3>Option B — Terminal</h3>
<pre style="margin-bottom:0"><code># Node.js (npx, no install needed)
npx serve .

# Python
python -m http.server 8000</code></pre>
    </div>

    <p>Then open <code>http://localhost:8000</code> (or whichever port) in your browser.</p>

    <hr>
    <p style="text-align:center; color: var(--text-mid); font-size: 0.95rem;">
      Built with vanilla HTML, CSS &amp; JavaScript. No frameworks, no build step, no magic.
    </p>

  </div>
</body>
</html>
